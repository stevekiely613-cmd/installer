name: Extract VSD (Final)
on: workflow_dispatch

jobs:
  rip_files:
    runs-on: windows-latest
    steps:
      - name: Download Installer
        run: Invoke-WebRequest -Uri "https://cdn.vsdinside.com/shopify_VSD/VSD-Craft-Installer_Windows.exe" -OutFile "vsd_setup.exe"

      - name: Rip Files with 7-Zip
        run: |
          Write-Host "Extracting with 7-Zip..."
          & "C:\Program Files\7-Zip\7z.exe" x "vsd_setup.exe" -o"extracted_vsd" -y
          Get-ChildItem "extracted_vsd"

      - name: Zip Everything
        run: |
          Compress-Archive -Path "extracted_vsd" -DestinationPath "vsd_portable.zip"

      - name: Upload to GitHub Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: VSD_Portable_Files
          path: vsd_portable.zip

      - name: Generate Public Download Links
        shell: bash
        run: |
          echo "--- LINK 1: File.io (Fast, expires after 1 download) ---"
          curl -F "file=@vsd_portable.zip" https://file.io
          
          echo " "
          echo "--- LINK 2: BashUpload (Backup) ---"
          curl https://bashupload.com/vsd_portable.zip --data-binary @vsd_portable.zip
